# HTTP 服务器配置示例

server:
  # 服务名称
  name: "example-api"
  
  # 协议类型: http, https, tcp, quic
  protocol: "http"
  
  # 监听地址 (TCP 端口)
  address: ":8080"
  
  # UNIX 套接字路径 (可选,与 address 二选一)
  # unix_path: "/tmp/app.sock"
  
  # 超时配置
  read_timeout: 30s
  write_timeout: 30s
  idle_timeout: 120s
  
  # 大小限制
  max_header_bytes: 1048576    # 1MB
  max_body_bytes: 10485760     # 10MB
  max_form_bytes: 10485760     # 10MB
  
  # 连接配置
  keep_alive: true
  server_agent: "UF/1.0"
  
  # TLS 配置 (仅 HTTPS 时启用)
  # tls:
  #   cert_file: "./cert.pem"
  #   key_file: "./key.pem"
  
  # HTTP/2 配置 (可选)
  http2:
    enabled: false
    max_concurrent_streams: 250
    max_read_frame_size: 1048576
  
  # 静态文件服务 (可选)
  static:
    enabled: false
    root: "./public"
    prefix: "/static"
    index: ["index.html", "index.htm"]
    browse: false
  
  # Cookie 配置
  cookie:
    domain: ""
    path: "/"
    max_age: 86400           # 24小时
    secure: false
    http_only: true
    same_site: "lax"         # strict, lax, none
  
  # Session 配置
  session:
    enabled: false
    provider: "memory"       # memory, redis, file
    cookie_name: "session_id"
    max_age: 3600            # 1小时
  
  # 中间件配置
  middleware:
    # 核心中间件 (默认启用)
    enable_trace: true       # 追踪中间件
    enable_logger: true      # 日志中间件
    enable_recovery: true    # 恢复中间件
    
    # CORS 中间件 (跨域支持)
    enable_cors: false
    cors:
      allow_origins: "*"
      allow_methods: "GET,POST,PUT,DELETE,PATCH,HEAD,OPTIONS"
      allow_headers: "*"
      allow_credentials: false
      expose_headers: ""
      max_age: 3600
    
    # CSRF 中间件 (跨站请求伪造保护)
    enable_csrf: false
    csrf:
      token_length: 32
      cookie_name: "csrf_token"
      header_name: "X-CSRF-Token"
      form_field_name: "csrf_token"
      cookie_path: "/"
      cookie_max_age: 3600
      skip_methods: ["GET", "HEAD", "OPTIONS", "TRACE"]
    
    # 超时中间件
    enable_timeout: false
    timeout: "30s"
    
    # 限流中间件
    enable_rate_limit: false
    rate_limit:
      max_requests: 100
      window: "1m"
  
  # 访问日志配置 (记录所有请求)
  access_log:
    enabled: true
    level: "info"            # debug, info, warn, error
    format: "json"           # json, text
    output: "stdout"         # stdout, stderr, file
    file_path: "./logs/access.log"
    max_size: 100            # MB
    max_backups: 10
    max_age: 30              # days
    compress: true
  
  # 错误日志配置 (仅记录错误请求)
  error_log:
    enabled: true
    level: "error"           # error 级别及以上
    format: "json"
    output: "stderr"         # 错误输出到 stderr
    file_path: "./logs/error.log"
    max_size: 100
    max_backups: 10
    max_age: 30
    compress: true
